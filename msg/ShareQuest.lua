local v0={};local v1=string.char;local v2=string.byte;local v3=string.sub;local v4=bit32 or bit ;local v5=v4.bxor;local v6=table.concat;local v7=table.insert;local function v8(v21,v22) local v23={};for v40=1, #v21 do v7(v23,v1(v5(v2(v3(v21,v40,v40 + 1 )),v2(v3(v22,1 + (v40% #v22) ,1 + (v40% #v22) + 1 )))%256 ));end return v6(v23);end local v9,v10=...;local v11=v10.Logger:NewLogger(v8("\226\203\218\55\227","\126\177\163\187\69\134\219\167"));local v12,v13=v10.QuestCatalogStatus,v10.QuestStatus;local v14,v15=v10.MessageEvents,v10.MessageDistribution;local v16,v17=v10.G.IsInGroup,v10.G.IsInRaid;local function v18(v24,v25,v26,v27) local v28=0;while true do if (v28==1) then return v24,v25;end if (v28==0) then if ((3291>1667) and ( not v24 or  not v24.metadata) and ( not v26 or  not v26.metadata)) then error(v8("\0\204\36\203\243\55\141\46\192\232\38\223\39\204\242\38\141\36\192\235\38\223\106\212\233\38\222\62\204\243\45\141\60\192\238\48\196\37\203\188\110\141\36\192\245\55\197\47\215\188\50\216\47\214\232\99\206\37\203\232\34\196\36\214\188\53\200\56\214\245\44\195\106\204\242\37\194\56\200\253\55\196\37\203","\156\67\173\74\165"));elseif ((v24 and v24.metadata and ( not v26 or  not v26.metadata)) or (873==2034)) then return v24,v25;elseif ((v26 and v26.metadata and ( not v24 or  not v24.metadata)) or (2816<11)) then return v26,v27;end if ((3699<4706) and (v26.metadata.compileDate==nil)) then return v24,v25;elseif ((2646>=876) and (v26.metadata.compileDate>v24.metadata.compileDate) and (v26.metadata.hash~=v24.metadata.hash)) then return v26,v27;end v28=1;end end end local function v19(v29) local v30=0;local v31;local v32;while true do if (v30==1) then v29,v32=v18(v29,v32,v10.QuestLog:FindByID(v31),v8("\154\49\21\37\103\137\244\172","\155\203\68\112\86\19\197"));v29,v32=v18(v29,v32,v10.QuestArchive:FindByID(v31),v8("\119\200\51\239\84\89\247\251\78\212\32\249","\152\38\189\86\156\32\24\133"));v30=2;end if (v30==0) then v31,v32=v29.questId,v8("\7\191\72\4\185\34","\38\84\215\41\118\220\70");v29,v32=v18(v29,v32,v10.QuestCatalog:FindByID(v31),v8("\97\3\39\1\234\115\23\54\19\242\95\17","\158\48\118\66\114"));v30=1;end if (v30==2) then v10.Logger:Trace(v8("\210\82\176\67\239\67\231\87\233\82\180\82\188\65\162\84\239\94\168\72\188\69\162\85\243\91\177\67\248\13\231\3\239\23\239\3\239\30","\38\156\55\199"),v32,tostring(v29.metadata.compileDate));return v29,v32;end end end v10.ShareQuest=function(v33,v34,v35) local v36=0;local v37;while true do if (v36==2) then if ((614<=3184) and  not v35) then local v72=0;while true do if (v72==0) then v34.metadata.giverName=v10:GetPlayerName();v34.metadata.giverRealm=v10:GetPlayerRealm();v72=1;end if (1==v72) then v34.metadata.giverGuild=v10:GetPlayerGuildName();break;end end end v37={};v36=3;end if (4==v36) then v10.Logger:Warn(v8("\122\74\1\55\64\76\7\101\88\87\5\54\93\2\69\54\7\12\78","\69\41\34\96"),v34.name);break;end if (v36==1) then v10:CleanQuest(v34);v10.QuestEngine:Validate(v34);v36=2;end if (v36==3) then if ((3126==3126) and v17()) then v37.distribution=v15.Raid;elseif (v16() or (2187>=4954)) then v37.distribution=v15.Party;else local v87=0;while true do if (v87==0) then v10.Logger:Warn("Tu dois être dans un groupe ou un raid pour partager une quête.");return;end end end v14:Publish(v8("\138\67\204\179\46\121\62\215\178\66\204","\161\219\54\169\192\90\48\80"),v37,v34);v36=4;end if (0==v36) then assert(type(v34)==v8("\188\124\126\36\22","\35\200\29\28\72\115\20\154") ,v8("\63\190\216\211\136\40\116\13\176\145\236\133\45\38\28\142\196\218\158\56\110\89\190\145\206\152\41\39\13\255\220\202\158\56\116\27\186\145\207\159\35\34\16\187\212\219","\84\121\223\177\191\237\76"));v34=v10:CopyTable(v34);v36=1;end end end;v10:OnBackendStart(function() local v38={[v13.Active]={[v8("\177\198\196\25\3\44\185","\75\220\163\183\106\98")]="%s a déjà cette quête en cours..."},[v13.Finished]={[v8("\15\191\152\36\216\5\191","\185\98\218\235\87")]="%s a fini cette quête mais ne l'a pas rendu."},[v13.Completed]={[v8("\198\57\52\245\223\173\206","\202\171\92\71\134\190")]="%s a terminé cette quête !"}};v14:Subscribe(v8("\24\212\41\155\61\232\34\158\32\213\41","\232\73\161\76"),function(v41,v42,v43) local v44=0;local v45;local v46;local v47;local v48;local v49;local v50;local v51;local v52;local v53;while true do if (v44==5) then v10.Logger:Warn("%s t'a invité à rejoindre la quête %s.",v42,v43.name);v53=v10.QuestEngine:EvaluateRequirements(v43);if (v53 or (3770>=4041)) then local v75=0;while true do if (v75==0) then v11:Trace(v8("\137\252\222\215\172\169\201\193\169\252\210\214\189\228\222\202\172\250\155\201\189\253\151\132\171\225\212\211\177\231\220\132\137\252\222\215\172\192\213\194\183\207\201\197\181\236","\164\216\137\187"));if (v10.QuestInfoFrame or (3791<=1611)) then v10.z:ShowQuest(v50.quest);end break;end end else local v76=0;while true do if (0==v76) then v10.Logger:Warn("Tu ne remplis pas les conditions requises pour cette quête.");v14:Publish(v8("\227\243\52\161\178\215\5\196\239\37\183\148\251\26\199\239\35\183\171\251\5\198\245","\107\178\134\81\210\198\158"),{[v8("\60\7\145\210\184\49\12\151\210\163\55\0","\202\88\110\226\166")]=v15.Whisper,[v8("\215\14\144\240\207\215","\170\163\111\226\151")]=v42},v43.questId);break;end end end break;end if (1==v44) then v10:CleanQuest(v43);v10.QuestEngine:Validate(v43);v46,v47=v10:MigrateQuest(v43);v44=2;end if (v44==0) then if (v43.quest or (3877==3575)) then local v77=0;while true do if (v77==0) then v10.Logger:Warn("%s essaye de partager une quête avec vous, mais elle est incompatible avec votre version de PMQ.",v42);v10.Logger:Warn("Demande à %s de mettre à jour PMQ à la version %s ou supérieure.",v42,v10:GetVersionText());v77=1;end if (1==v77) then v14:Publish(v8("\138\204\71\78\10\146\215\84\84\10\190\253\71\94\18\178\215\71\89","\126\219\185\34\61"),{[v8("\8\199\77\102\108\126\241\242\24\199\81\124","\135\108\174\62\18\30\23\147")]=v15.Whisper,[v8("\162\232\56\204\29\186","\167\214\137\74\171\120\206\83")]=v42});return;end end end v45=nil;v43,v45=v19(v43);v44=1;end if (3==v44) then if ( not v50 or (546>=2684)) then local v78=0;while true do if (0==v78) then v50=v10.QuestCatalog:NewCatalogItem(v43);v48=true;break;end end else local v79=0;while true do if (v79==0) then v43,v45=v18(v50.quest,v8("\249\59\37\147\160\58\253\220\47\44\143\179","\156\168\78\64\224\212\121"),v43,v45);if ((1465<=4301) and (v45~=v8("\54\251\160\221\19\205\164\218\6\226\170\201","\174\103\142\197"))) then local v92=0;while true do if (v92==1) then v49=true;break;end if (v92==0) then v50.quest=v43;v48=true;v92=1;end end end break;end end end if ((1704>1425) and v48) then v10.QuestCatalog:Save(v50,v12.Invited);end v51=nil;v44=4;end if (v44==2) then if ((707>632) and  not v46) then local v80=0;while true do if (0==v80) then v10.Logger:Warn("%s essaye de partager une quête avec vous, mais elle est incompatible voici l'erreur %s.",v42,v47);v10.Logger:Warn("Demande lui de mettre à jour PMQ à la version %s ou supérieure.",v10:GetVersionText());v80=1;end if (v80==1) then v14:Publish(v8("\186\229\55\78\236\142\133\230\59\73\253\131\142\243\62\84\246\162\143","\199\235\144\82\61\152"),{[v8("\3\31\170\63\21\31\187\62\19\31\182\37","\75\103\118\217")]=v15.Whisper,[v8("\211\85\98\19\188\10","\126\167\52\16\116\217")]=v42});return;end end end v48,v49=false,false;v50=v10.QuestCatalog:FindByID(v43.questId);v44=3;end if (v44==4) then v52=v10.QuestLog:FindByID(v43.questId);if ((v52 and v38[v52.status]) or (687==4234)) then local v81=0;while true do if (v81==0) then v11:Trace("La quête est un doublon: déjà dans le journal avec le statut '%s'",v52.status);v51=v52.status;break;end end else local v82=0;local v83;while true do if (v82==0) then v83=v10.QuestArchive:FindByID(v43.questId);if ((v83 and v38[v83.status]) or (3330<1429)) then local v93=0;while true do if (v93==0) then v11:Trace("La quête est un doublon: déjà dans l'archive avec le statut '%s'",v83.status);v51=v83.status;break;end end end break;end end end if ((1147>=335) and v51) then local v84=0;while true do if (v84==1) then return;end if (v84==0) then v14:Publish(v8("\103\61\90\43\49\119\246\64\33\75\61\1\75\232\90\33\92\57\49\91","\152\54\72\63\88\69\62"),{[v8("\208\205\253\72\198\205\236\73\192\205\225\82","\60\180\164\142")]=v15.Whisper,[v8("\76\95\23\46\34\249","\114\56\62\101\73\71\141")]=v42},v43.questId,v51);if ((3435>2097) and v49) then local v94=0;while true do if (v94==0) then v10.Logger:Warn("%s a mis à jour la quête %s dans votre catalogue.",v42,v43.name);v10.Logger:Warn("Démarre cette quête depuis le catalogue pour voir les changements.");break;end end end v84=1;end end end v44=5;end end end);v14:Subscribe(v8("\32\37\183\43\90\30\39\7\57\166\61\111\52\42\20\32\166\61\74","\73\113\80\210\88\46\87"),function(v54,v55,v56) v10.Logger:Warn("%s a accepté votre quête.",v55);end);v14:Subscribe(v8("\176\57\200\1\243\168\34\219\27\243\132\8\200\17\235\136\34\200\22","\135\225\76\173\114"),function(v57,v58,v59) v10.Logger:Warn("%s a rejeté votre quête.",v58);end);v14:Subscribe(v8("\43\248\189\163\184\148\169\12\228\172\181\136\168\183\22\228\187\177\184\184","\199\122\141\216\208\204\221"),function(v60,v61,v62,v63) if ((v63 and v38[v63]) or (4578<=2008)) then v10.Logger:Warn(v38[v63].message,v61);end end);v14:Subscribe(v8("\156\200\21\227\108\223\163\203\25\228\125\196\168\204\5\249\106\243\160\216\30\228\107","\150\205\189\112\144\24"),function(v64,v65,v66) v10.Logger:Warn("%s ne rempli pas les conditions requises pour cette quête.",v65);end);local function v39(v67,v68) if ((1125<=2076) and v67.metadata.giverName) then v14:Publish(v68,{[v8("\33\141\172\88\22\129\19\5\49\141\176\66","\112\69\228\223\44\100\232\113")]=v15.Whisper,[v8("\192\30\21\212\179\104","\230\180\127\103\179\214\28")]=v67.metadata.giverName},v67.questId);end end v10.AppEvents:Subscribe(v8("\189\16\90\85\240\96\227\143\0\79\82\225\69","\128\236\101\63\38\132\33"),function(v69) v39(v69,v8("\157\188\20\87\162\194\193\186\160\5\65\151\232\204\169\185\5\65\178","\175\204\201\113\36\214\139"));end);v10.AppEvents:Subscribe(v8("\118\217\48\207\16\99\201\54\208\13\73\201\49","\100\39\172\85\188"),function(v70) v39(v70,v8("\156\109\188\147\39\132\118\175\137\39\168\92\188\131\63\164\118\188\132","\83\205\24\217\224"));end);end);